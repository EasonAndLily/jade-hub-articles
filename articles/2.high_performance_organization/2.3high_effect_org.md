# 高效能组织模式

![org-structure](https://s1.locimg.com/2024/02/15/f77323d41e81f.jpeg)

通过《康威定律》我们深刻的认识到“如果系统的架构和组织结构不一致，那么组织结构将成为赢家！”。高效能软件开发团队是任何组织能够持续交付价值的关键，将团队视为交付的基础，团队结构和沟通路径能够随着技术和组织成熟度的发展而演变。

特别是，当组织被划分为职能竖井时，难以面向端到端的工作流设计一个良好架构的软件系统。同理，如果一个组织主要根据不同地域的销售渠道来划分，那么就难以开发出一种有效的软件架构来面向全球所有区域提供多样性的软件服务。如何通过软件架构来有效的设计一个组织结构呢？IT顾问Matthew Skelton和Manuel Pais的著作《高效能团队模式：支持软件快速交付的组织架构》为我们深刻的阐述了一种高效能的组织架构。

## 团队拓扑

为了尽可能地实现高效，我们需要持续设计团队而不是让他们野蛮生长。我们称之为有意识的团队结构设计，也就是团队拓扑，承认团队在组织中应该有所定位，同时明确每个团队的职责边界。

在团队间，依赖关系通常分为三类：知识依赖、任务依赖和资源依赖。这些依赖关系在团队协作和项目管理中起着重要作用。

* **知识依赖**：知识依赖是指一个团队在完成任务或项目时，需要依赖另一个团队的专业知识、技能或经验。这种依赖关系通常出现在跨职能团队或项目团队中，当一个团队缺乏完成某项任务所需的特定知识时，它需要向另一个团队寻求帮助。知识依赖可以是正式的，例如通过明确的培训、指导或咨询；也可以是非正式的，例如通过团队成员之间的非正式交流。
* **任务依赖**：任务依赖是指一个团队的任务或活动需要等待另一个团队完成任务或活动才能开始。这种依赖关系通常出现在项目中的多个阶段，当一个团队的工作依赖于另一个团队的工作成果时。任务依赖可以是线性的，即一个团队的工作成果直接作为另一个团队的工作输入；也可以是间接的，即一个团队的工作成果通过多个中间步骤才能影响到另一个团队的工作。
* **资源依赖**：资源依赖是指一个团队在完成任务或项目时，需要依赖另一个团队提供的资源，如人力、设备、资金等。这种依赖关系通常出现在资源有限的情况下，当一个团队无法自行满足项目所需资源时，它需要向另一个团队寻求支持。资源依赖可以是长期的，例如在项目执行过程中持续依赖外部资源；也可以是短期的，例如在特定阶段或任务中需要外部资源的支持。

好的团队拓扑结构应该让知识、任务和资源更加内聚，减少被这三者强依赖而导致团队工作处处受限。

### 通过业务领域边界划分团队拓扑

领域，即问题域、问题空间，领域是一种边界、范围。所以，一个领域代表了一个问题域的边界，也可以理解为是一个业务的边界。领域边界越大，业务范围就越大，反之则相反；通常我们大家交流都比较喜欢用业务这一词，比如这块业务，那块业务，业务的边界，比如我是一个业务开发人员（区分于我是一个中间件开发人员）。

领域既然是一个边界，所以可以划分领域的大小，即领域划分，划分出来的子领域简称子域，每个子域对应一个小的问题域和和小的业务；当然，不同的子域的重要性也是不同的，所以才有了核心子域、支撑子域的说法，这点显而易见。

通常，每个业务域都有一个对应的业务模型，注意这个业务模型不是领域模型，而是一个业务概念的模型，是从业务本身出发，分析业务边界范围内的各种业务概念，以及业务概念之间的关系，通常我们可以使用一个业务模型的图来表达这些业务概念以及业务概念之间的关系。

一个业务域实际上就是由一组业务活动构成的，业务活动中的角色和任务，体现了所有参与到价值创造过程中的组织单元的分工协作关系。通常，我们发现，在业务域的内部，知识、任务和资源更加内聚，业务域与业务域之间则依赖较少，所以业务域与业务域之间是存在着天然的裂痕，这种天然的裂痕是在企业经营过程中，被特定的知识、技能和行业、角色分工等促进下形成的。

![domain team architecture](https://s1.locimg.com/2024/02/17/e5f588f107652.png)

所以，杰出的架构师应该致力于寻找业务域的边界，将业务域的边界划分团队，那么团队的拓扑结构就自然形成了。

## 高效能组织模式

基于业务域的边界和团队的沟通路径，《高效能团队模式》中设计了一种高效能的组织模型：

![high-effect-team-architeture](https://s1.locimg.com/2024/02/18/5b353c322f0cb.png)

该模型将团队分为四种类似的拓扑结构：
1. **平台型团队**：该类型的团队应当提供产品领域型团队所需的底层服务，比如Devops，支付，认证相关的服务，目的使得产品领域型团队无须开发底层服务，降低了认知负荷，促进了产品的快速研发和迭代。平台团队需要重点关注服务的可用性和可靠性，并将平台视为一种产品，需要定期回访用户以确认服务的可用性，以及服务是否依然满足用户需求。
2. **产品领域型团队**：流动式团队是组织中最主要的团队类型，其他基本团队拓扑的目标都是为了减轻流动式团队的负担。该类型的团队是通过产品的业务领域区分不同的团队，比如在一个电商系统中，可以根据业务领域，区分为聚焦订单的团队、聚焦商品的团队、聚焦售后的团队等。每个小团队里面可能具备多重角色，比如开发、测试和产品等，都有自己商业上面的目标、计划和任务，多个团队之间协同，共同完成高价值产品的交付。需要着重强调的是，该团队尽量职责单一，团队较小，最好是两个披萨能把团队喂饱。
3. **复杂子系统团队**：复杂子系统团队负责构建和维护系统中严重依赖专业领域知识的子系统。处理复杂和专业的工作需要具备特定能力的专家，他们通常很难培养或者寻找。复杂的例子如：视频编码和解码、某财务报税服务系统、人脸识别引擎，AI专家等。在团队成长的初期，搭建该类型的团队通常耗时耗力，此时可以寻找第三方合作伙伴来完成。
4. **全功能团队**：该团队由来自特定技术领域或产品领域的专家组成，他们熟悉系统的方方面面，他们可以和公司高层对接，输出产品演进的技术方案和业务规划，从更高维度来看待团队的发展。全功能团队一方面进行调研工作，尝试不同方案，并在工具、实践、框架、技术栈等方面给出高质量的建议，另一方面当团队或产品遇到重大困难时，能全局调动资源，牵头解决问题。

软件交付过程中的许多问题都是由于不同团队之间的边界和他们的职责一时的不清晰造成的。我们需要寻找天然的方法来拆分系统（根据破裂面），使产生的各个部分尽可能独立演进。由此，分配到这些部分的团队将体验到更多的自主权。将子系统边界与业务（主要是独立的）部分对齐是一个很好的方法，高效能组织模式就是在这种理念的指导下衍生出来的。

需要注意的是，在任何情况下，必须使软件的特性团队人员规模保持稳定，以便团队能够以可持续的方式有效地主导和演进他们所负责的软件。

## 高效能团队交互模式

定义好团队的边界后，还需要明确团队直接的交互方式，《高效能组织模式》建议我们让团队之间的交互“动”起来。

### 三种交互模式

使用一组良好定义的团队交互模式，能避免团队与软件间模糊不清的对应关系，子系统间的边界和API因此变得清晰。兼顾团队优先动态原理和康威定律，我们使用如下三种核心交互模式。

![team-iteraction](https://s1.locimg.com/2024/02/18/7813a03aecf56.png)

* **协作**：与另一个团队密切合作。有利于创新和快速探索，但边界不清。
* **服务（X-as-a-Service）**：使用或提供某种服务，而尽量减少协作。职责清晰、交付可预期，但依赖有效的产品管理。服务团队需要完成卓越的工作才能将部分内容服务化，这虽然不容易，但这么一来交付团队就无须过多地理解他们工作之外的非核心细节，帮助他们更快速地实现交付。优点是：如果服务使用方不需要与服务提供方有太多沟通就能使用服务，那么服务使用方就可以高效率地工作。这意味着，在服务模式下，由于服务可以开箱即用，而无须关注其底层实现细节，服务使用方可以快速实现功能，这是使用服务模式最大价值。
* **促进**：为提供或者寻求其他团队的帮助而清除障碍。例如，一个产品领域型通常使用协作模式或服务模式与其他团队交互，而平台团队和复杂子系统团队大部分情况下使用服务模式，而赋能团队需要较多的指导和促进经验来支持产品领域型团队。

### 团队拓扑不断演进

![Team Evolution](https://s1.locimg.com/2024/02/18/45d044d460947.png)

如上图是一个企业中团队拓扑的演进过程，团队1不断地与平台团队协作，探索新的模式和采用新技术的方式。这种探索活动最终使得团队2采用服务模式构建与平台团队的关系。而团队3及之后的团队就可以使用最新版本的平台，从而实现服务化而不需要与平台团队紧密协作。

我们可以在不同时期为组织的不同部分设计不同的团队拓扑，以适应团队目标和环境。那么什么时候团队拓扑要演进？
* 当我们软件对于一个团队来说太大了, 业务领域太多了，职责变得不清晰时
* 交付节奏开始变慢
* 多种业务服务依赖于一个大型的底层服务