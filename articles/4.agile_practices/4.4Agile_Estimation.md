# 敏捷估算

![estimate-poster.png](https://img.picui.cn/free/2024/09/17/66e905197e3a0.png)

在敏捷软件开发的广阔舞台上，估算不仅是计划的基石，更是项目管理的导航灯。缺乏估算，就如同航行于茫茫大海而无罗盘，难以把握航向。然而，实践中我们常目睹估算引发的种种挑战与误解，这些声音往往伴随着对功能堆砌的盲目追求而响起。

当项目陷入“特性竞赛”的漩涡，一味追求数量的堆砌而非质量的深耕，估算便可能沦为牺牲品。此时，团队成员不再聚焦于项目的实际成效，而是被特性清单的完成度所牵引，估算的初衷被扭曲，甚至成为阻碍项目健康的绊脚石。

更进一步，估算还承载着设立期望值的重任，但这些期望往往过于乐观，忽略了软件开发中的不确定性与复杂性。一旦项目遭遇延期或特性削减，这些未能达成的期望便会被视为失败的标志，进而引发对风险的过度恐慌与责任的相互推诿。

在这样的背景下，估算往往成为团队成员情绪宣泄的靶心，被误解为敏捷实践的绊脚石。于是，一种偏见悄然滋生——认为沉迷于精确估算的人并非真正的敏捷信徒。而外界对敏捷的质疑也随之而来，认为敏捷不过是鼓励开发者盲目行动，缺乏明确目标与承诺的代名词。

为了进一步理解估算的价值，我们先了解两种估算方式：

## 两种估算方式

业界存在两种估算方式：一种是基于理想人天的估算方式，另一种是基于复杂度的故事点估算方式。

### 理想人天估算

理想人天估算建立在几个理想化假设之上：每项故事独立且专注进行，无外界干扰，所有前置条件均已就绪。这种估算类似于故事点的相对大小评估，但更容易让人陷入任务清单的细枝末节中，而非从整体视角审视故事间的相对难度。

值得注意的是，理想时间并不等同于实际耗用时间。正如NBA比赛的理想时间与实际耗用时间的差异，软件开发中的估算也需考虑会议、讨论等额外因素。此外，不同人对同一任务的估算可能存在偏差，这要求我们在估算时保持谨慎，并意识到其潜在的不准确性。

对于初涉敏捷或尚不熟悉故事点估算的团队而言，理想人天估算提供了一种更为直观和易于接受的起点。它便于向团队外部解释，也便于基于历史数据预测团队的开发速度。

### 故事点估算

与理想人天估算不同，故事点估算专注于用户故事的相对大小和实现难度，而非具体的天数或工作量。它采用斐波那契数列等标准，鼓励团队从整体上评估故事的复杂性和工作量。

通常基数为1的基准故事被称作基准点，是团队基于共识共同确立的，每个团队都不一样。一般每个团队的故事点按照斐波那契数列来进行估计：1,2,3,5,8,13...，如果一个故事卡的实现难度超过3，小于5的时候，就会估算为5，以此类推即可。如果一张故事卡估算为3，说明比那个估算为1的实现复杂的和难度提升三倍。

![agile_poker.jpg](https://img.picui.cn/free/2024/09/17/66e943ff53a6a.jpg)

故事点估算的核心在于建立一个共识的基准点，并以此为基准进行相对评估。这种方法不受团队技术能力或业务领域熟悉度的影响，确保了估算的稳定性和一致性。比如，一个点数为3的用户故事，它的复杂度相对于那个点数为1的基准故事来说不会发生变化，不管谁、也不管用什么技术来开发这个用户故事。

故事点的大小是指团队所有角色工作加一起的统一估算数值，需要多个角色一起合作讨论才能得出这个估算，因此，故事点的估算方法有利于帮助团队实现跨功能合作的行为。特别注意，不应该按照开发的点数、测试的点数去估算用户故事的大小，需要结合一起给出一个唯一的数值。

在初期，故事点估算可能会因团队对规则和标准的理解不足而显得不够准确。但随着迭代的推进和团队经验的积累，这种估算方式将逐渐趋于稳定可靠，为项目的顺利进行提供有力支持。

#### 摸牌游戏

在启动新项目时，确定首个迭代的故事点确实是一个挑战。您提到的“摸牌游戏”是一种非常实用的方法，旨在通过团队成员的自我评估和集体讨论来初步确定团队的产能。这种方法不仅能帮助团队建立对故事点估算的共识，还能促进成员间的沟通与协作。

在“摸牌游戏”中，每位团队成员从Backlog中挑选出自己认为在当前迭代内能够完成的故事卡，并为其分配一个初步的故事点数。通过多轮选择（如3到5轮），每次选择不同的故事卡，可以收集到更多关于团队整体产能的数据。最终，通过计算这些点数的平均值，可以大致确定团队在首个迭代中的故事点数目标。

例如：
| 次数 | A | B | C | D | E |
| -- | -- | -- | -- | -- | -- |
| 第一轮 | 8 | 13 | 5 | 8 | 13|
| 第二轮 | 5 | 8 | 8 | 13 | 8|
| 第三轮 | 13 | 13 | 5 | 8 | 5|

最终计算结果为：(（8+13+5+8+13) + (5+8+8+13+13+8) + (13+13+5+8+5)) ÷ 3 = 48.6

所以，确定为第一个迭代的故事点是48.6， 那么我们需要挑选故事卡，点数之和与这个值差不多就行。

需要注意的是，这种方法得出的结果是一个参考值，而非绝对数值。随着项目的推进和团队对故事点估算的深入理解，这个数值可能会进行调整。此外，为了确保估算的准确性，团队应该保持开放和诚实的态度，避免过度乐观或悲观的估算。

## 速度(Velocity)

速度是对团队的进度生产率的度量，可以通过计算团队在一次迭代中完成的用户故事所分配的故事点数的总和来得到。比如，一个迭代完成5个3个点的用户故事，那么速度是15; 如果完成了2个5个点的用户故事，速度是10。关于“完成” 的定义不能只是到“开发完成”，而应该是“交付完成”，开发完成不能说明什么，可能后续测试还不能过关、有很多缺陷需要修复等情况。

速度可以修正计划的误差。估算把对工作量的估算和对工作时长的估算完全隔离开来，将必须完成的所有用户故事的点数总和除以迭代的速度，可以推算出迭代的次数，也就是项目持续时间。

速度不会是稳定不变的。根据团队对技术和业务领域知识的熟悉程度，速度可能会增加;而随着团队人员调整，有新人加入以后，速度可能会下降。在故事点估算准确的情况下，速度正好是反映团队状态的一个参数。不应该为了保持速度的不变去调整估算的结果，而应该根据速度的变化来观察和分析团队的健康程度。

### 累积流图

在敏捷软件开发中，累积流图（Cumulative Flow Diagram, CFD）是一种强大的可视化工具，它帮助团队长期追踪项目进度、识别瓶颈、评估交付效率，并据此调整策略以优化团队效能。

#### 累积流图的构建

累积流图通过绘制三个主要区域来展示项目状态：
* **待处理（Backlog）**：表示尚未开始处理的故事点总数。这些故事点通常已经过估算，但尚未被分配到任何迭代中。
* **进行中（In Progress）**：表示当前正在开发、测试或等待评审的故事点总数。这个区域的大小反映了团队的并行工作能力和当前的工作量。
* **已完成（Done）**：表示已经通过所有必要阶段（包括开发、测试、评审等）并被认为是可交付的故事点总数。
每个区域都随时间推移而累积增长，形成三条曲线。这些曲线的斜率、间距和交点提供了丰富的信息，帮助团队理解其工作流程和效率

![Cumulative-Flow-Diagram.png](https://s1.locimg.com/2024/09/17/2d84fbf2fefc5.png)

### 累积流图的价值：
* **识别瓶颈**：如果“进行中”区域的曲线持续上升而“已完成”区域的曲线增长缓慢，这可能表明团队在某个环节遇到了瓶颈，如测试资源不足、代码审查延迟等。通过识别这些瓶颈，团队可以针对性地采取措施来解决问题。
* **评估交付效率**：通过比较“已完成”区域曲线的斜率与团队预期的速度，可以评估团队的交付效率。如果实际速度低于预期，团队需要分析原因并调整策略以提高效率。
* **优化流程**：累积流图揭示了故事点在不同阶段的停留时间（Cycle Time），这有助于团队识别哪些阶段耗时最长，从而优化这些阶段的流程。例如，如果测试阶段耗时过长，团队可以考虑增加测试资源、改进测试方法或提前介入测试工作。
* **预测未来**：基于累积流图的历史数据，团队可以预测未来一段时间内的交付情况。这有助于团队更好地规划迭代内容、分配资源和调整项目计划。

综上所述，累积流图在敏捷项目管理和团队效能追踪中发挥着至关重要的作用。它不仅能够帮助团队识别瓶颈、评估效率、优化流程、帮助团队发现问题并修正计划，还能够促进团队成员之间的沟通与协作，推动项目向着既定目标顺利推进。

## 正确看待估算

> 估算是为了更好的做计划，通过估算推算出的持续时间是一种可能性，而不是对交付时限的一种承诺。估算的是用户故事固有的属性，其大小不应该受到交付时长的干扰。

许多团队发现，估算提供了一种有用的机制，可以促使团队成员间彼此交流。估算会议可以帮助大家以不同的方式，对实现即将开始的故事、未来的架构方向和代码库中的设计问题，有更好的理解。在这种情况下，任何输出的估算数字可能都不重要。这样的讨论可能以很多方式发生，但如果这些讨论没有发生，就可以引入关于估算的讨论。相反地，如果你考虑停止估算，你需要确保估算时会发生的任何有效的讨论，在其他地方还能够继续进行。

估算本身并无好坏之分。如果你不用估算就可以有效地工作，那就这么干。如果你需要一些估算，那就要确认你很清楚估算在决策时起到的作用。如果估算会影响到重大的决定，那就尽可能做出最好的估算。一定要小心那帮告诉你任何时候都要做估算，或者从来不需要估算的人。任何关于估算用法的争论，都要遵从于敏捷的原则，即针对你特定的上下文，决定你该采用的什么样的方法。