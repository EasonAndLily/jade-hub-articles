# 敏捷估算

![estimate-poster.png](https://img.picui.cn/free/2024/09/17/66e905197e3a0.png)

没有估算，就没法计划，没有计划，就无法对项目进行管理。

然而，现实的情况是，我们经常听到因为估算导致的种种问题，各种抱怨。这种场景往往发生在过分追逐产品具有更多的功能特性时，过分追逐特性是一种很糟糕的情形，人们只是始热衷于完成一个又一个特性，而不是追踪项目的真实结果，此时，估算就会变成实质有害的行为。

估算还会设定期望值，这些期望值通常会偏低；任何时间上的增长，或者软件特性被砍掉，都会被视作是失败。出于对风险的逃避，这些失败的后果往往会被放大。

面对类似这样的情况，我们就很容易看到团队成员把愤怒对准了估算本身。这样也导致越来越多的人认为，任何沉迷于估算的人并不是真正的敏捷实践者。而批评敏捷的人则说，这意味着敏捷软件开发的本质就是，开发者很快动手开始做，却并不明确要做什么，而且承诺说，该做完的时候肯定会做完它，而且你肯定会喜欢它。

为了进一步理解估算的价值，我们先了解两种估算方式：

## 两种估算方式

业界存在两种估算方式：一种是基于理想人天的估算方式，另一种是基于复杂度的故事点估算方式。

### 理想人天的估算

理想人天的估算需要基于这样的假设:
* 所估算的故事是唯一要做的工作
* 所有需要的东西在故事开始前都会准备好
* 故事开发过程中不会被打断。 在不考虑其他因素的情况下，这种理想人天的估算是类似于故事点的估算方 法，同样是一种相对大小的估算。

理想时间跟耗用时间是不同的。比如一场 NBA 比赛的理想时间为 12 分钟一 小节，但是实际比赛耗用时间需要比这个时间长很多，因为中间有暂停、死球等时间。理想人天的估算是基于理想时间的，在软件开发过程中会有多个因素导致实际耗用时间跟理想时间会有很大的不同，比如开会、讨论等。

理想人天的估算方法很容易让人根据一个故事所需完成的任务多少去估算，而不是从这个故事跟其他故事的相对大小角度去考虑;不同人估算的理想人天也会有不同，导致估算可能会不太准确。这在估算的时候是需要特别注意的。

在团队不熟悉故事点估算方法的初期，理想人天的估算方法更容易开始;理想人天的估算对于团队外部人员更容易解释清楚，也更方便预测速度。

### 故事点估算

故事点是纯粹对用户故事大小的相对度量，是对用户故事实现难度和负责度的相对衡量，不应该跟任何的天数或者工作量等关联。

通常基数为1的基准故事被称作基准点，是团队基于共识共同确立的，每个团队都不一样。一般每个团队的故事点按照斐波那契数列来进行估计：1,2,3,5,8,13...，如果一个故事卡的实现难度超过3，小于5的时候，就会估算为5，以此类推即可。如果一张故事卡估算为3，说明比那个估算为1的实现复杂的和难度提升三倍。

![agile_poker.jpg](https://img.picui.cn/free/2024/09/17/66e943ff53a6a.jpg)

用户故事本身的大小属性不会发生变化，基于故事点的估算不会过期，不会受到团队技术能力和业务领域熟悉度的影响而发生变化。比如，一个点数为3的用户故事，它的复杂度相对于那个点数为1的基准故事来说不会发生变化，不管谁、也不管用什么技术来开发这个用户故事。

故事点的大小是指团队所有角色工作加一起的统一估算数值，需要多个角色 一起合作讨论才能得出这个估算，因此，故事点的估算方法有利于帮助团队 实现跨功能合作的行为。特别注意，不应该按照开发的点数、测试的点数去 估算用户故事的大小，需要结合一起给出一个唯一的数值。

基于故事点的估算方式，在团队刚刚开始的几个迭代，可能不太准确，但是随着团队的自我调整和对规则的不断理解，故事点的估算方式会在波动中不断趋于稳定，可靠。

#### 摸牌游戏

这个存在一个问题，如果是新的项目，第一个迭代的故事点该如何确定呢？有一个经典的玩法是“摸牌游戏”，假设团队中有5个开发，每个开发从BackLog中选择自己能在当前迭代中有自信完成的故事卡出来，每个人就可以获得一个点数，团队成员的所有点数就是总点数，如此循环3到5次，每次让每个人选择的故事卡不同，计算出一个平均数，就是当前团队的第一个迭代的故事点数。

例如：
| 次数 | A | B | C | D | E |
| -- | -- | -- | -- | -- | -- |
| 第一轮 | 8 | 13 | 5 | 8 | 13|
| 第二轮 | 5 | 8 | 8 | 13 | 8|
| 第三轮 | 13 | 13 | 5 | 8 | 5|

最终计算结果为：(（8+13+5+8+13) + (5+8+8+13+13+8) + (13+13+5+8+5)) ÷ 3 = 48.6

所以，确定为第一个迭代的故事点是48.6， 那么我们需要挑选故事卡，点数之和与这个值差不多就行。

## 速度(Velocity)

速度是对团队的进度生产率的度量，可以通过计算团队在一次迭代中完成的用户故事所分配的故事点数的总和来得到。比如，一个迭代完成5个3个点的用户故事，那么速度是15; 如果完成了2个5个点的用户故事，速度是10。关于“完成” 的定义不能只是到“开发完成”，而应该是“交付完成”，开发完成不能说明什么，可能后续测试还不能过关、有很多缺陷需要修复等情况。

速度可以修正计划的误差。估算把对工作量的估算和对工作时长的估算完全隔离开来，将必须完成的所有用户故事的点数总和除以迭代的速度，可以推算出迭代的次数，也就是项目持续时间。

速度不会是稳定不变的。根据团队对技术和业务领域知识的熟悉程度，速度可能会增加;而随着团队人员调整，有新人加入以后，速度可能会下降。在故事点估算准确的情况下，速度正好是反映团队状态的一个参数。不应该为了保持速度的不变去调整估算的结果，而应该根据速度的变化来观察和分析团队的健康程度。

### 累积流图

累积流图是用于长期追踪团队速度的有用工具，通过这个图，我们能够清除的看到团队对计划误差的修正，长期追踪我们能看到团队速度的提升。

![Cumulative-Flow-Diagram.png](https://s1.locimg.com/2024/09/17/2d84fbf2fefc5.png)

累积流图是一个面积图，它显示随着时间的推移，不同阶段的故事点数量的变化。横轴代表时间，纵轴代表故事点数量。通过累积流图，团队可以观察到：
* WIP：开发中的估点数减去已完成的估点数。
* 交付速率：已完成的点数除以时间，即已完成点数曲线的斜率。
* Cycle time: 故事点在每个阶段的停留时间。

累积流图除了能够统计上述基础信息外，其最有价值的地方是识别和分析项目风险，帮助团队发现问题，修正计划。
例如：如果一段时间内三条线条均没有增长，说明此时团队无法交付故事卡出来，这并不是一个好的现象，需要进一步进行分析，是否因为团队近期进行了休假？或者近期团队有重大阻塞，导致团队成员没法进行工作？通过累积流图，就能够发现当前项目的风险，识别并处理这些风险，帮助团队回归到正轨上。

## 正确看待估算

> 估算是为了更好的做计划，通过估算推算出的持续时间是一种可能性，而不是对交付时限的一种承诺。估算的是用户故事固有的属性，其大小不应该受到交付时长的干扰。

许多团队发现，估算提供了一种有用的机制，可以促使团队成员间彼此交流。估算会议可以帮助大家以不同的方式，对实现即将开始的故事、未来的架构方向和代码库中的设计问题，有更好的理解。在这种情况下，任何输出的估算数字可能都不重要。这样的对话可能以很多方式发生，但如果这些对话没有发生，就可以引入关于估算的讨论。相反地，如果你考虑停止估算，你需要确保估算时会发生的任何有效的对话，在其他地方还能够继续进行。

估算本身并无好坏之分。如果你不用估算就可以有效地工作，那就这么干。如果你需要一些估算，那就要确认你很清楚估算在决策时起到的作用。如果估算会影响到重大的决定，那就尽可能做出最好的估算。一定要小心那帮告诉你任何时候都要做估算，或者从来不需要估算的人。任何关于估算用法的争论，都要遵从于敏捷的原则，即针对你特定的上下文，决定你该采用的什么样的方法。